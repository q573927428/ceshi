// utils/valueCalculator.js

// 1️⃣ 拆分稀有度数组
export const specialCardsData = [
    100028, 100372, 100479
  ]; // 特殊卡
  
  export const sssCardsData = [
    100496, 100477, 100476, 100478, 100480, 100498,100615, 
    100526, 100030, 100016, 100035, 100023, 100027, 100013, 100451, 100619
  ]; // 超核心SSS
  
  export const ssCardsData = [
    100337, 100685, 100670, 100692, 100649, 100787, 100807, 100808,
    100771, 100794, 100704, 100703, 100708, 100709, 100792, 100799, 100785
  ]; // SS卡
  
  export const sCardsData = [
    100449, 100604, 100443, 100620, 100021, 102001, 100648, 100074, 102012,
    100574, 100741, 100589, 100618, 100671, 100645, 100474, 100022, 100677,
    100784, 100630, 100534, 100647, 100452, 100701, 100705, 100796, 100791,
    100802, 100805, 100783, 100769, 100687
  ]; // S卡
  
  export const aCardsData = [
    100072, 100450, 100358, 100020, 100616, 100034, 100090, 100024, 100003,
    100631, 100519, 100582, 100553, 100788, 100689, 100653, 100683, 100707,
    100494, 102016, 100019, 100702, 100524, 100790, 100795, 100801, 100800,
    100691, 100793
  ]; // A卡

// 2️⃣ 定义稀有度倍数
export const cardAdvanceRates = {
  special: 1.6,  // 特殊卡
  sss: 1.1,      // 超核心SSS
  ss: 2,       // SS卡
  s: 0.1,        // S卡
  a: 0.1         // A卡
};

// 3️⃣ 定义基础值
export const cardBaseValues = {
    // 特殊卡 specialCardsData
    100028: 100, 100372: 100, 100479: 150, 100477: 80, 100476: 80, 100478: 80, 100480: 80, 100498: 120, 100496: 100, 

    // 超核心SSS sssCardsData
    100526: 120, 100030: 150, 100016: 150, 100035: 120, 100023: 180, 100027: 30, 100013: 150, 100451: 100, 100619: 60, 

    // SS卡 ssCardsData
    100615: 10, 100337: 20, 100685: 30, 100670: 20, 100692: 10, 100649: 10, 100787: 200, 100807: 300, 100808: 50, 
    100771: 80, 100794: 80, 100704: 80, 100703: 80, 100708: 80, 100709: 80, 100792: 100, 100799: 80, 100785: 50, 
    
    // S卡 sCardsData
    100449: 30, 100604: 30, 100443: 30, 100620: 30, 100021: 30, 102001: 30, 100648: 30, 100074: 30, 102012: 30, 
    100574: 30, 100741: 30, 100589: 30, 100618: 30, 100671: 30, 100645: 30, 100474: 30, 100022: 30, 100677: 30, 
    100784: 30, 100630: 30, 100534: 30, 100647: 30, 100452: 30, 100701: 30, 100705: 30, 100796: 30, 100791: 30, 
    100802: 30, 100805: 30, 100783: 30, 100769: 30, 100687: 30,
    
    // A卡 aCardsData
    100072: 10, 100450: 10, 100358: 10, 100020: 10, 100616: 10, 100034: 10, 100090: 10, 100024: 10, 100003: 10, 100631: 10, 
    100519: 10, 100582: 10, 100553: 10, 100788: 10, 100689: 10, 100653: 10, 100683: 10, 100707: 10, 100494: 10, 102016: 10, 
    100019: 10, 100702: 10, 100524: 10, 100790: 10, 100795: 10, 100801: 10, 100800: 10, 100691: 10, 100793: 10
};


// 每星进阶加成（只针对特殊卡和SSS卡），每多一星贡献递增
function getAdvanceMultiplier(card) {
    const advanceNum = card.advance_num || 0;
  
    // 只对特殊卡和SSS卡生效
    if (!(specialCardsData.includes(card.hero_id) || sssCardsData.includes(card.hero_id) || ssCardsData.includes(card.hero_id)) ) {
      return 1; // 无加成
    }
  
    let total = 1.8; // 基础倍率
    let factor = 0.3; // 第一星的加成倍率，可调整
  
    for (let i = 1; i <= advanceNum; i++) {
      total += factor;
      factor *= 2.6; // 每多一星，贡献递增，指数增长
    }
  
    return total;
  }
  
  // 获取卡牌价值
  export function getCardValue(card) {
    const defaultCardBaseValue = 5;
    const baseValue = cardBaseValues[card.hero_id] ?? defaultCardBaseValue;
  
    // 稀有度倍数
    let rarityRate = 1;
    if (specialCardsData.includes(card.hero_id)) rarityRate = cardAdvanceRates.special;
    else if (sssCardsData.includes(card.hero_id)) rarityRate = cardAdvanceRates.sss;
    else if (ssCardsData.includes(card.hero_id)) rarityRate = cardAdvanceRates.ss;
    else if (sCardsData.includes(card.hero_id)) rarityRate = cardAdvanceRates.s;
    else if (aCardsData.includes(card.hero_id)) rarityRate = cardAdvanceRates.a;
  
    // 进阶加成
    const advanceMultiplier = getAdvanceMultiplier(card);
  
    return Math.round(baseValue * rarityRate * advanceMultiplier);
  }


export const weaponValues =  {
    '别鸣': {
        红: { "机敏": 10000, "灵动": 5000, other: 3000 },
        粉: { "机敏": 1000, "灵动": 800, other: 500 },
        蓝: { "机敏": 100, "灵动": 0, other: 0 },
    },
    '博浪': {
        红: { "机敏": 10000, "仁心": 5000, other: 3000 },
        粉: { "机敏": 1000, "仁心": 800, other: 500 },
        蓝: { "机敏": 100, "仁心": 0, other: 0 },
    },
    '比翼': {
        红: { "济世": 10000, "仁心": 5000, other: 3000 },
        粉: { "济世": 1000, "仁心": 800, other: 500 },
        蓝: { "济世": 100, "仁心": 0, other: 0 },
    },
    '承影': {
        红: { "筹算": 10000, "天资": 5000, other: 3000 },
        粉: { "筹算": 1000, "天资": 800, other: 500 },
        蓝: { "筹算": 100, "天资": 0, other: 0 },
    },
    '沧海': {
        红: { "戒备": 10000, "坚韧": 5000, other: 3000 },
        粉: { "戒备": 1000, "坚韧": 800, other: 50 },
        蓝: { "戒备": 100, "坚韧": 0, other: 0 },
    },
    '大将': {
        红: { "灵动": 10000, "机敏": 5000, other: 3000 },
        粉: { "灵动": 1000, "机敏": 800, other: 500 },
        蓝: { "灵动": 100, "机敏": 0, other: 0 },
    },
    '大橹': {
        红: { "机敏": 10000, "稳固": 5000, other: 3000 },
        粉: { "机敏": 1000, "稳固": 800, other: 500 },
        蓝: { "机敏": 100, "稳固": 0, other: 0 },
    },
    '惊鲵': {
        红: { "英勇": 10000, "骁锐": 5000, other: 3000 },
        粉: { "英勇": 1000, "骁锐": 800, other: 500 },
        蓝: { "英勇": 100, "骁锐": 0, other: 0 },
    },
    '旌阳万仞': {
        红: { "筹算": 10000, "天资": 5000, other: 3000 },
        粉: { "筹算": 1000, "天资": 800, other: 500 },
        蓝: { "筹算": 100, "天资": 0, other: 0 },
    },
    '钜黍': {
        红: { "骁锐": 10000, "天资": 5000, other: 3000 },
        粉: { "骁锐": 1000, "天资": 800, other: 500 },
        蓝: { "骁锐": 100, "天资": 0, other: 0 },
    },
    '锟铻': {
        红: { "筹算": 10000, "天资": 5000, other: 3000 },
        粉: { "筹算": 1000, "天资": 800, other: 500 },
        蓝: { "筹算": 100, "天资": 0, other: 0 },
    },
    '龙鳞': {
        红: { "骁锐": 10000, "奔袭": 5000, other: 3000 },
        粉: { "骁锐": 1000, "奔袭": 800, other: 500 },
        蓝: { "骁锐": 100, "奔袭": 100, other: 0 },
    },
    '冥山勾月': {
        红: { "英勇": 10000, "晓锐": 5000, other: 3000 },
        粉: { "英勇": 1000, "晓锐": 800, other: 500 },
        蓝: { "英勇": 100, "晓锐": 100, other: 0 },
    },
    '铭鸿': {
        红: { "筹算": 10000, "英勇": 5000, other: 3000 },
        粉: { "筹算": 1000, "英勇": 800, other: 500 },
        蓝: { "筹算": 100, "英勇": 100, other: 0 },
    },
    '屈卢': {
        红: { "骁锐": 10000, "奔袭": 5000, other: 3000 },
        粉: { "骁锐": 1000, "奔袭": 800, other: 500 },
        蓝: { "骁锐": 100, "奔袭": 0, other: 0 },
    },
    '戚': {
        红: { "骁锐": 10000, "坚毅": 5000, other: 3000 },
        粉: { "骁锐": 1000, "坚毅": 800, other: 500 },
        蓝: { "骁锐": 100, "坚毅": 0, other: 0 },
    },
    '千钧': {
        红: { "灵动": 10000, "稳固": 5000, other: 3000 },
        粉: { "灵动": 1000, "稳固": 800, other: 500 },
        蓝: { "灵动": 100, "稳固": 0, other: 0 },
    },
    '仁风': {
        红: { "灵动": 10000, "仁心": 5000, other: 3000 },
        粉: { "灵动": 1000, "仁心": 800, other: 500 },
        蓝: { "灵动": 100, "仁心": 0, other: 0 },
    },
    '少府': {
        红: { "骁锐": 10000, "陷阵": 5000, other: 3000 },
        粉: { "骁锐": 1000, "陷阵": 800, other: 500 },
        蓝: { "骁锐": 100, "陷阵": 0, other: 0 },
    },
    '神锋': {
        红: { "骁锐": 10000, "陷阵": 5000, other: 3000 },
        粉: { "骁锐": 1000, "陷阵": 800, other: 500 },
        蓝: { "骁锐": 100, "陷阵": 0, other: 0 },
    },
    '彤素': {
        红: { "英勇": 10000, "至策": 5000, other: 3000 },
        粉: { "英勇": 1000, "至策": 800, other: 500 },
        蓝: { "英勇": 100, "至策": 0, other: 0 },
    },
    '泰阿': {
        红: { "机敏": 10000, "灵动": 5000, other: 3000 },
        粉: { "机敏": 1000, "灵动": 800, other: 500 },
        蓝: { "机敏": 100, "灵动": 0, other: 0 },
    },
    '螣蛇': {
        红: { "熟虑": 10000, "天资": 5000, other: 3000 },
        粉: { "熟虑": 1000, "天资": 800, other: 500 },
        蓝: { "熟虑": 100, "天资": 0, other: 0 },
    },
    '乌号': {
        红: { "熟虑": 10000, "亢厉": 5000, other: 3000 },
        粉: { "熟虑": 1000, "亢厉": 800, other: 500 },
        蓝: { "熟虑": 100, "亢厉": 0, other: 0 },
    },
    '悬翦': {
        红: { "骁锐": 10000, "筹算": 5000, other: 3000 },
        粉: { "骁锐": 1000, "筹算": 800, other: 500 },
        蓝: { "骁锐": 100, "筹算": 0, other: 0 },
    },
    '徐氏匕首': {
        红: { "筹算": 10000, "天资": 5000, other: 3000 },
        粉: { "筹算": 1000, "天资": 800, other: 500 },
        蓝: { "筹算": 100, "天资": 0, other: 0 },
    },
    '貅猊': {
        红: { "骁锐": 10000, "坚毅": 5000, other: 3000 },
        粉: { "骁锐": 1000, "坚毅": 800, other: 500 },
        蓝: { "骁锐": 100, "坚毅": 0, other: 0 },
    },
    '星汉': {
        红: { "戒备": 10000, "不屈": 5000, other: 3000 },
        粉: { "戒备": 1000, "不屈": 800, other: 500 },
        蓝: { "戒备": 100, "不屈": 0, other: 0 },
    },
    '游飘': {
        红: { "筹算": 10000, "天资": 5000, other: 3000 },
        粉: { "筹算": 1000, "天资": 800, other: 500 },
        蓝: { "筹算": 100, "天资": 0, other: 0 },
    },
    '掩日': {
        红: { "熟虑": 10000, "天资": 5000, other: 3000 },
        粉: { "熟虑": 1000, "天资": 800, other: 500 },
        蓝: { "熟虑": 100, "天资": 0, other: 0 },
    },
    '元戎': {
        红: { "骁锐": 10000, "天资": 5000, other: 3000 },
        粉: { "骁锐": 1000, "天资": 800, other: 500 },
        蓝: { "骁锐": 100, "天资": 0, other: 0 },
    },
    '狰角枪': {
        红: { "骁锐": 10000, "奔袭": 5000, other: 3000 },
        粉: { "骁锐": 1000, "奔袭": 800, other: 500 },
        蓝: { "骁锐": 100, "奔袭": 0, other: 0 },
    },
    '真刚': {
        红: { "骁锐": 10000, "破敌": 5000, other: 3000 },
        粉: { "骁锐": 1000, "破敌": 800, other: 500 },
        蓝: { "骁锐": 100, "破敌": 0, other: 0 },
    },
    '障日': {
        红: { "惑言": 10000, "机敏": 5000, other: 3000 },
        粉: { "惑言": 1000, "机敏": 800, other: 500 },
        蓝: { "惑言": 100, "机敏": 0, other: 0 },
    }
};

export function getWeaponValue(weapon) {
  const name = weapon?.name;
  const color = weapon?.color;
  const featureName = weapon?.feature?.[0]?.[0];
  if (!name || !color || !featureName) return 0;
  const weaponData = weaponValues[name];
  if (!weaponData) return 0;
  const colorData = weaponData[color];
  if (!colorData) return 0;
  return colorData[featureName] ?? colorData.other ?? 0;
}
